@using FluentSignals.ServerTest.Components

<div class="tabbed-code-block">
    <div class="code-tabs">
        <button class="@GetTabClass("csharp")" @onclick='() => SelectTab("csharp")'>
            <span class="tab-icon">ðŸ”·</span>
            C# Code
        </button>
        @if (!string.IsNullOrEmpty(RazorCode))
        {
            <button class="@GetTabClass("razor")" @onclick='() => SelectTab("razor")'>
                <span class="tab-icon">ðŸ“„</span>
                Razor Code
            </button>
        }
    </div>
    <div class="code-content">
        @if (selectedTab == "csharp")
        {
            <CodeBlock Code="@CSharpCode" Language="csharp" Title="@CSharpTitle" />
        }
        else if (selectedTab == "razor")
        {
            <CodeBlock Code="@RazorCode" Language="razor" Title="@RazorTitle" />
        }
    </div>
</div>

@code {
    [Parameter] public string CSharpCode { get; set; } = "";
    [Parameter] public string? RazorCode { get; set; }
    [Parameter] public string CSharpTitle { get; set; } = "C# Code";
    [Parameter] public string RazorTitle { get; set; } = "Razor Code";
    
    private string selectedTab = "csharp";
    
    protected override void OnInitialized()
    {
        // If no C# code but Razor code exists, show Razor by default
        if (string.IsNullOrEmpty(CSharpCode) && !string.IsNullOrEmpty(RazorCode))
        {
            selectedTab = "razor";
        }
    }
    
    private void SelectTab(string tab)
    {
        selectedTab = tab;
    }
    
    private string GetTabClass(string tab)
    {
        return $"code-tab {(selectedTab == tab ? "active" : "")}";
    }
}
